<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Cleaning | Data: The Mungening</title>
  <meta name="description" content="‘Magic the Gathering’ Project for NCF 2020 Graduate Program" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Cleaning | Data: The Mungening" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="‘Magic the Gathering’ Project for NCF 2020 Graduate Program" />
  <meta name="github-repo" content="seankross/bookdown-start" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Cleaning | Data: The Mungening" />
  
  <meta name="twitter:description" content="‘Magic the Gathering’ Project for NCF 2020 Graduate Program" />
  

<meta name="author" content="Sara Haman, Miles Tweed, Conor Howlett, Kevin Howlett" />


<meta name="date" content="2020-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-quality-metrics.html"/>
<link rel="next" href="descriptive-statistics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Bookdown Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-the-gathering.html"><a href="data-the-gathering.html"><i class="fa fa-check"></i><b>2</b> Data the Gathering</a><ul>
<li class="chapter" data-level="2.1" data-path="data-the-gathering.html"><a href="data-the-gathering.html#market-data"><i class="fa fa-check"></i><b>2.1</b> 2019 Market Data</a></li>
<li class="chapter" data-level="2.2" data-path="data-the-gathering.html"><a href="data-the-gathering.html#market-data-1"><i class="fa fa-check"></i><b>2.2</b> 2020 Market Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-quality-metrics.html"><a href="data-quality-metrics.html"><i class="fa fa-check"></i><b>3</b> Data Quality Metrics</a><ul>
<li class="chapter" data-level="3.1" data-path="data-quality-metrics.html"><a href="data-quality-metrics.html#set-up"><i class="fa fa-check"></i><b>3.1</b> Set-up</a></li>
<li class="chapter" data-level="3.2" data-path="data-quality-metrics.html"><a href="data-quality-metrics.html#the-functions"><i class="fa fa-check"></i><b>3.2</b> The Functions</a></li>
<li class="chapter" data-level="3.3" data-path="data-quality-metrics.html"><a href="data-quality-metrics.html#quality-assessments"><i class="fa fa-check"></i><b>3.3</b> Quality Assessments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-cleaning.html"><a href="data-cleaning.html"><i class="fa fa-check"></i><b>4</b> Data Cleaning</a><ul>
<li class="chapter" data-level="4.1" data-path="data-cleaning.html"><a href="data-cleaning.html#packages"><i class="fa fa-check"></i><b>4.1</b> Packages</a></li>
<li class="chapter" data-level="4.2" data-path="data-cleaning.html"><a href="data-cleaning.html#the-cleaning-script"><i class="fa fa-check"></i><b>4.2</b> The Cleaning Script</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-cleaning.html"><a href="data-cleaning.html#post-download-formatting"><i class="fa fa-check"></i><b>4.2.1</b> Post-Download Formatting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>5</b> Descriptive Statistics</a><ul>
<li class="chapter" data-level="5.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#set-up-1"><i class="fa fa-check"></i><b>5.1</b> Set-up</a></li>
<li class="chapter" data-level="5.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#descriptives"><i class="fa fa-check"></i><b>5.2</b> Descriptives</a></li>
<li class="chapter" data-level="5.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#distribution-of-prices"><i class="fa fa-check"></i><b>5.3</b> Distribution of Prices</a></li>
<li class="chapter" data-level="5.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#correlation-of-numerical-data"><i class="fa fa-check"></i><b>5.4</b> Correlation of Numerical Data</a></li>
<li class="chapter" data-level="5.5" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#printing-type"><i class="fa fa-check"></i><b>5.5</b> Printing type</a></li>
<li class="chapter" data-level="5.6" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#frame-version"><i class="fa fa-check"></i><b>5.6</b> Frame Version</a></li>
<li class="chapter" data-level="5.7" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#release-date"><i class="fa fa-check"></i><b>5.7</b> Release Date</a></li>
<li class="chapter" data-level="5.8" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#rarity"><i class="fa fa-check"></i><b>5.8</b> Rarity</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="feature-analysis.html"><a href="feature-analysis.html"><i class="fa fa-check"></i><b>6</b> Feature Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="feature-analysis.html"><a href="feature-analysis.html#prices"><i class="fa fa-check"></i><b>6.1</b> Prices</a></li>
<li class="chapter" data-level="6.2" data-path="feature-analysis.html"><a href="feature-analysis.html#artist-influence"><i class="fa fa-check"></i><b>6.2</b> Artist Influence</a></li>
<li class="chapter" data-level="6.3" data-path="feature-analysis.html"><a href="feature-analysis.html#game-mechanics"><i class="fa fa-check"></i><b>6.3</b> Game Mechanics</a></li>
<li class="chapter" data-level="6.4" data-path="feature-analysis.html"><a href="feature-analysis.html#text-features"><i class="fa fa-check"></i><b>6.4</b> Text Features</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>7</b> Discussion</a><ul>
<li class="chapter" data-level="7.1" data-path="discussion.html"><a href="discussion.html#conclusion"><i class="fa fa-check"></i><b>7.1</b> Conclusion</a></li>
<li class="chapter" data-level="7.2" data-path="discussion.html"><a href="discussion.html#future-directions"><i class="fa fa-check"></i><b>7.2</b> Future Directions</a></li>
<li class="chapter" data-level="7.3" data-path="discussion.html"><a href="discussion.html#what-we-learned-along-the-way"><i class="fa fa-check"></i><b>7.3</b> What We Learned Along the Way</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data: The Mungening</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-cleaning" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Cleaning</h1>
<div id="packages" class="section level2">
<h2><span class="header-section-number">4.1</span> Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-cleaning.html#cb1-1"></a><span class="co">###############################################</span></span>
<span id="cb1-2"><a href="data-cleaning.html#cb1-2"></a><span class="co">##########    </span><span class="al">###</span><span class="co">  LIBRARIES  </span><span class="al">###</span><span class="co">    ##########</span></span>
<span id="cb1-3"><a href="data-cleaning.html#cb1-3"></a><span class="co">###############################################</span></span>
<span id="cb1-4"><a href="data-cleaning.html#cb1-4"></a></span>
<span id="cb1-5"><a href="data-cleaning.html#cb1-5"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="data-cleaning.html#cb1-6"></a><span class="kw">library</span>(plotly)</span>
<span id="cb1-7"><a href="data-cleaning.html#cb1-7"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="data-cleaning.html#cb1-8"></a><span class="kw">library</span>(gganimate)</span>
<span id="cb1-9"><a href="data-cleaning.html#cb1-9"></a><span class="kw">library</span>(magick)</span>
<span id="cb1-10"><a href="data-cleaning.html#cb1-10"></a><span class="kw">library</span>(gifski)</span>
<span id="cb1-11"><a href="data-cleaning.html#cb1-11"></a><span class="kw">library</span>(png)</span>
<span id="cb1-12"><a href="data-cleaning.html#cb1-12"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-13"><a href="data-cleaning.html#cb1-13"></a><span class="kw">library</span>(PerformanceAnalytics)</span>
<span id="cb1-14"><a href="data-cleaning.html#cb1-14"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb1-15"><a href="data-cleaning.html#cb1-15"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb1-16"><a href="data-cleaning.html#cb1-16"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb1-17"><a href="data-cleaning.html#cb1-17"></a><span class="kw">library</span>(extrafont)</span>
<span id="cb1-18"><a href="data-cleaning.html#cb1-18"></a><span class="kw">library</span>(tm)</span></code></pre></div>
</div>
<div id="the-cleaning-script" class="section level2">
<h2><span class="header-section-number">4.2</span> The Cleaning Script</h2>
<p>The script below reads in the csv’s needed and, at the end, outputs a merged CSV file containing the card and 2019 prices data joined by applicable columns. The inline comments explain what the script is doing at each stage. This data will later be compared with the 2020 price data, which is fundamentally a very different data set, though it has some variables that can be directly compared. This will be expanded on during the analysis.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-cleaning.html#cb2-1"></a><span class="co">###############################################</span></span>
<span id="cb2-2"><a href="data-cleaning.html#cb2-2"></a><span class="co">##########    </span><span class="al">###</span><span class="co">    CARDS    </span><span class="al">###</span><span class="co">    ##########</span></span>
<span id="cb2-3"><a href="data-cleaning.html#cb2-3"></a><span class="co">###############################################</span></span>
<span id="cb2-4"><a href="data-cleaning.html#cb2-4"></a></span>
<span id="cb2-5"><a href="data-cleaning.html#cb2-5"></a><span class="co"># READING IN THE DATA</span></span>
<span id="cb2-6"><a href="data-cleaning.html#cb2-6"></a>cardsRaw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;cards.csv&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-7"><a href="data-cleaning.html#cb2-7"></a><span class="co"># head(cardsRaw)</span></span>
<span id="cb2-8"><a href="data-cleaning.html#cb2-8"></a></span>
<span id="cb2-9"><a href="data-cleaning.html#cb2-9"></a><span class="co">#SELECTING RELEVANT COLUMNS</span></span>
<span id="cb2-10"><a href="data-cleaning.html#cb2-10"></a>keepCols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;uuid&quot;</span>, <span class="st">&quot;mcmId&quot;</span>, <span class="st">&quot;mtgjsonV4Id&quot;</span>, <span class="st">&quot;multiverseId&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;artist&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;subtypes&quot;</span>, <span class="st">&quot;supertypes&quot;</span>, <span class="st">&quot;manaCost&quot;</span>, <span class="st">&quot;convertedManaCost&quot;</span>, <span class="st">&quot;keywords&quot;</span>, <span class="st">&quot;text&quot;</span>, <span class="st">&quot;flavorText&quot;</span>,  <span class="st">&quot;power&quot;</span>, <span class="st">&quot;toughness&quot;</span>, <span class="st">&quot;rarity&quot;</span>, <span class="st">&quot;edhrecRank&quot;</span>, <span class="st">&quot;isOnlineOnly&quot;</span>)</span>
<span id="cb2-11"><a href="data-cleaning.html#cb2-11"></a>cards &lt;-<span class="st"> </span><span class="kw">select_</span>(cardsRaw, <span class="dt">.dots =</span> keepCols)</span>
<span id="cb2-12"><a href="data-cleaning.html#cb2-12"></a><span class="co"># head(cards)</span></span>
<span id="cb2-13"><a href="data-cleaning.html#cb2-13"></a></span>
<span id="cb2-14"><a href="data-cleaning.html#cb2-14"></a><span class="co"># CLEANING TYPES</span></span>
<span id="cb2-15"><a href="data-cleaning.html#cb2-15"></a>cards<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">word</span>(cards<span class="op">$</span>type, <span class="dv">1</span>, <span class="dt">sep=</span><span class="st">&quot; —&quot;</span>)</span>
<span id="cb2-16"><a href="data-cleaning.html#cb2-16"></a></span>
<span id="cb2-17"><a href="data-cleaning.html#cb2-17"></a><span class="co"># REMOVING SPECIAL CHARACTERS FROM THE TEXT VARIABLES</span></span>
<span id="cb2-18"><a href="data-cleaning.html#cb2-18"></a>cards<span class="op">$</span>text &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(cards<span class="op">$</span>text, <span class="st">&quot;[[:punct:]]&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-19"><a href="data-cleaning.html#cb2-19"></a>cards<span class="op">$</span>flavorText &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(cards<span class="op">$</span>flavorText, <span class="st">&quot;[[:punct:]]&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-20"><a href="data-cleaning.html#cb2-20"></a></span>
<span id="cb2-21"><a href="data-cleaning.html#cb2-21"></a><span class="co"># CLEANING THE MANA CLUSTERF**K</span></span>
<span id="cb2-22"><a href="data-cleaning.html#cb2-22"></a><span class="co"># If the manaCost is NA, replace it with Z so that it can be processed by str_detect. Converted back later.</span></span>
<span id="cb2-23"><a href="data-cleaning.html#cb2-23"></a>cards<span class="op">$</span>manaCost &lt;-<span class="st"> </span><span class="kw">replace_na</span>(cards<span class="op">$</span>manaCost, <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb2-24"><a href="data-cleaning.html#cb2-24"></a></span>
<span id="cb2-25"><a href="data-cleaning.html#cb2-25"></a><span class="co">#Removing the brackets</span></span>
<span id="cb2-26"><a href="data-cleaning.html#cb2-26"></a>cards<span class="op">$</span>manaCost =<span class="st"> </span><span class="kw">str_replace_all</span>(cards<span class="op">$</span>manaCost, <span class="st">&quot;[{}]&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-27"><a href="data-cleaning.html#cb2-27"></a></span>
<span id="cb2-28"><a href="data-cleaning.html#cb2-28"></a><span class="co">#Creating a variable to hold the &#39;generic&#39; mana cost</span></span>
<span id="cb2-29"><a href="data-cleaning.html#cb2-29"></a>cards<span class="op">$</span>genericManaCost &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb2-30"><a href="data-cleaning.html#cb2-30"></a></span>
<span id="cb2-31"><a href="data-cleaning.html#cb2-31"></a><span class="co"># Counting the generic mana cost for each row</span></span>
<span id="cb2-32"><a href="data-cleaning.html#cb2-32"></a>  <span class="co"># If X is included in the data, that means the # of generic mana is determined by the game environment</span></span>
<span id="cb2-33"><a href="data-cleaning.html#cb2-33"></a></span>
<span id="cb2-34"><a href="data-cleaning.html#cb2-34"></a>c =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-35"><a href="data-cleaning.html#cb2-35"></a><span class="cf">for</span> (i <span class="cf">in</span> cards<span class="op">$</span>manaCost){</span>
<span id="cb2-36"><a href="data-cleaning.html#cb2-36"></a>  a =<span class="st"> </span><span class="kw">str_detect</span>(i, <span class="st">&quot;.*[0-9].*&quot;</span>)</span>
<span id="cb2-37"><a href="data-cleaning.html#cb2-37"></a>  <span class="cf">if</span> ( a <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){</span>
<span id="cb2-38"><a href="data-cleaning.html#cb2-38"></a>    <span class="cf">if</span> (<span class="kw">substr</span>(i, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">1</span>) <span class="op">==</span><span class="st"> &#39;X&#39;</span>){</span>
<span id="cb2-39"><a href="data-cleaning.html#cb2-39"></a>      cards<span class="op">$</span>genericManaCost[c] &lt;-<span class="st"> &quot;Determined in Game&quot;</span></span>
<span id="cb2-40"><a href="data-cleaning.html#cb2-40"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-41"><a href="data-cleaning.html#cb2-41"></a>    cards<span class="op">$</span>genericManaCost[c] &lt;-<span class="st"> </span><span class="kw">substr</span>(i, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">stop =</span> <span class="dv">1</span>) </span>
<span id="cb2-42"><a href="data-cleaning.html#cb2-42"></a>    }</span>
<span id="cb2-43"><a href="data-cleaning.html#cb2-43"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-44"><a href="data-cleaning.html#cb2-44"></a>    cards<span class="op">$</span>genericManaCost[c] &lt;-<span class="st"> &quot;No Generic Cost&quot;</span></span>
<span id="cb2-45"><a href="data-cleaning.html#cb2-45"></a>  }</span>
<span id="cb2-46"><a href="data-cleaning.html#cb2-46"></a>c =<span class="st"> </span>c <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-47"><a href="data-cleaning.html#cb2-47"></a>}</span>
<span id="cb2-48"><a href="data-cleaning.html#cb2-48"></a></span>
<span id="cb2-49"><a href="data-cleaning.html#cb2-49"></a><span class="co"># Cleaning manaCost to remove data pertaining to generic mana</span></span>
<span id="cb2-50"><a href="data-cleaning.html#cb2-50"></a>cards<span class="op">$</span>manaCost &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(cards<span class="op">$</span>manaCost, <span class="st">&#39;X&#39;</span>, <span class="st">&#39;&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-51"><a href="data-cleaning.html#cb2-51"></a><span class="st">  </span><span class="kw">removeNumbers</span>()</span>
<span id="cb2-52"><a href="data-cleaning.html#cb2-52"></a></span>
<span id="cb2-53"><a href="data-cleaning.html#cb2-53"></a><span class="co"># HANDLING CARD COLOR</span></span>
<span id="cb2-54"><a href="data-cleaning.html#cb2-54"></a><span class="co"># Creating the color variable</span></span>
<span id="cb2-55"><a href="data-cleaning.html#cb2-55"></a>cards<span class="op">$</span>manaColor &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb2-56"><a href="data-cleaning.html#cb2-56"></a></span>
<span id="cb2-57"><a href="data-cleaning.html#cb2-57"></a><span class="co"># Splitting the letters so that they can be compared, these are put in a temporary variable </span></span>
<span id="cb2-58"><a href="data-cleaning.html#cb2-58"></a>cards<span class="op">$</span>temp &lt;-<span class="st"> </span><span class="kw">str_split</span>(cards<span class="op">$</span>manaCost, <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-59"><a href="data-cleaning.html#cb2-59"></a></span>
<span id="cb2-60"><a href="data-cleaning.html#cb2-60"></a><span class="co"># Identifying the mana color </span></span>
<span id="cb2-61"><a href="data-cleaning.html#cb2-61"></a>  <span class="co"># If the card deals with more than one type of mana, it is assigned to the category &quot;Multiple Types&quot;</span></span>
<span id="cb2-62"><a href="data-cleaning.html#cb2-62"></a>c =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-63"><a href="data-cleaning.html#cb2-63"></a><span class="cf">for</span> (i <span class="cf">in</span> cards<span class="op">$</span>temp){</span>
<span id="cb2-64"><a href="data-cleaning.html#cb2-64"></a>  <span class="cf">if</span> (<span class="kw">length</span>(i) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>){</span>
<span id="cb2-65"><a href="data-cleaning.html#cb2-65"></a>    cards<span class="op">$</span>manaColor[c] &lt;-<span class="st"> </span>i[<span class="dv">1</span>]</span>
<span id="cb2-66"><a href="data-cleaning.html#cb2-66"></a>  } <span class="cf">else</span> <span class="cf">if</span>(i[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span>i[<span class="dv">2</span>]) {</span>
<span id="cb2-67"><a href="data-cleaning.html#cb2-67"></a>    cards<span class="op">$</span>manaColor[c] &lt;-<span class="st"> </span>i[<span class="dv">1</span>]</span>
<span id="cb2-68"><a href="data-cleaning.html#cb2-68"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-69"><a href="data-cleaning.html#cb2-69"></a>    cards<span class="op">$</span>manaColor[c] &lt;-<span class="st"> &quot;Multiple Types&quot;</span></span>
<span id="cb2-70"><a href="data-cleaning.html#cb2-70"></a>}</span>
<span id="cb2-71"><a href="data-cleaning.html#cb2-71"></a>c =<span class="st"> </span>c<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-72"><a href="data-cleaning.html#cb2-72"></a>}</span>
<span id="cb2-73"><a href="data-cleaning.html#cb2-73"></a></span>
<span id="cb2-74"><a href="data-cleaning.html#cb2-74"></a><span class="co"># Colored mana cost is calculated by simply taking the length of the manaCost string (i.e., WWW would be 3)</span></span>
<span id="cb2-75"><a href="data-cleaning.html#cb2-75"></a>cards<span class="op">$</span>colorManaCost &lt;-<span class="st"> </span><span class="kw">nchar</span>(cards<span class="op">$</span>manaCost) </span>
<span id="cb2-76"><a href="data-cleaning.html#cb2-76"></a></span>
<span id="cb2-77"><a href="data-cleaning.html#cb2-77"></a><span class="co">#Handling NA&#39;s </span></span>
<span id="cb2-78"><a href="data-cleaning.html#cb2-78"></a>cards<span class="op">$</span>manaColor[<span class="kw">is.na</span>(cards<span class="op">$</span>manaColor)] &lt;-<span class="st"> &quot;No Color&quot;</span></span>
<span id="cb2-79"><a href="data-cleaning.html#cb2-79"></a>cards<span class="op">$</span>manaColor[cards<span class="op">$</span>manaColor <span class="op">==</span><span class="st"> &#39;Z&#39;</span>] &lt;-<span class="st"> &quot;No Color&quot;</span></span>
<span id="cb2-80"><a href="data-cleaning.html#cb2-80"></a>cards<span class="op">$</span>colorManaCost &lt;-<span class="st"> </span><span class="kw">ifelse</span>(cards<span class="op">$</span>manaColor <span class="op">==</span><span class="st"> &quot;No Color&quot;</span>, <span class="st">&quot;No Color Cost&quot;</span>, cards<span class="op">$</span>colorManaCost)</span>
<span id="cb2-81"><a href="data-cleaning.html#cb2-81"></a></span>
<span id="cb2-82"><a href="data-cleaning.html#cb2-82"></a><span class="co">#Removing the depreciated columns</span></span>
<span id="cb2-83"><a href="data-cleaning.html#cb2-83"></a>cards &lt;-<span class="st"> </span><span class="kw">subset</span>(cards, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(temp, manaCost))</span>
<span id="cb2-84"><a href="data-cleaning.html#cb2-84"></a></span>
<span id="cb2-85"><a href="data-cleaning.html#cb2-85"></a><span class="co">###############################################</span></span>
<span id="cb2-86"><a href="data-cleaning.html#cb2-86"></a><span class="co">##########    </span><span class="al">###</span><span class="co">    SETS     </span><span class="al">###</span><span class="co">    ##########</span></span>
<span id="cb2-87"><a href="data-cleaning.html#cb2-87"></a><span class="co">###############################################</span></span>
<span id="cb2-88"><a href="data-cleaning.html#cb2-88"></a></span>
<span id="cb2-89"><a href="data-cleaning.html#cb2-89"></a><span class="co"># READING IN THE DATA</span></span>
<span id="cb2-90"><a href="data-cleaning.html#cb2-90"></a>setsRaw &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;sets.csv&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-91"><a href="data-cleaning.html#cb2-91"></a><span class="co"># head(setsRaw)</span></span>
<span id="cb2-92"><a href="data-cleaning.html#cb2-92"></a></span>
<span id="cb2-93"><a href="data-cleaning.html#cb2-93"></a><span class="co">#SELECTING RELEVANT COLUMNS</span></span>
<span id="cb2-94"><a href="data-cleaning.html#cb2-94"></a>keepColsSets &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mcmId&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;releaseDate&quot;</span>)</span>
<span id="cb2-95"><a href="data-cleaning.html#cb2-95"></a>sets &lt;-<span class="st"> </span><span class="kw">select_</span>(setsRaw, <span class="dt">.dots =</span> keepColsSets) <span class="op">%&gt;%</span></span>
<span id="cb2-96"><a href="data-cleaning.html#cb2-96"></a><span class="st">  </span><span class="kw">rename</span>(</span>
<span id="cb2-97"><a href="data-cleaning.html#cb2-97"></a>    <span class="st">&quot;setName&quot;</span> =<span class="st"> &quot;name&quot;</span></span>
<span id="cb2-98"><a href="data-cleaning.html#cb2-98"></a>  )</span>
<span id="cb2-99"><a href="data-cleaning.html#cb2-99"></a>sets &lt;-<span class="st"> </span>sets[<span class="op">!</span><span class="kw">is.na</span>(sets<span class="op">$</span>mcmId), ]</span>
<span id="cb2-100"><a href="data-cleaning.html#cb2-100"></a></span>
<span id="cb2-101"><a href="data-cleaning.html#cb2-101"></a></span>
<span id="cb2-102"><a href="data-cleaning.html#cb2-102"></a><span class="co">###############################################</span></span>
<span id="cb2-103"><a href="data-cleaning.html#cb2-103"></a><span class="co">##########    </span><span class="al">###</span><span class="co">    JOIN     </span><span class="al">###</span><span class="co">    ##########</span></span>
<span id="cb2-104"><a href="data-cleaning.html#cb2-104"></a><span class="co">###############################################</span></span>
<span id="cb2-105"><a href="data-cleaning.html#cb2-105"></a><span class="co"># Joining cards with sets on MCM ID</span></span>
<span id="cb2-106"><a href="data-cleaning.html#cb2-106"></a>mtg &lt;-<span class="st"> </span><span class="kw">left_join</span>(cards, sets, <span class="dt">by =</span> <span class="st">&quot;mcmId&quot;</span>)</span>
<span id="cb2-107"><a href="data-cleaning.html#cb2-107"></a></span>
<span id="cb2-108"><a href="data-cleaning.html#cb2-108"></a><span class="co"># head(mtg)</span></span>
<span id="cb2-109"><a href="data-cleaning.html#cb2-109"></a><span class="co"># sum(is.na(mtg$releaseDate))</span></span>
<span id="cb2-110"><a href="data-cleaning.html#cb2-110"></a></span>
<span id="cb2-111"><a href="data-cleaning.html#cb2-111"></a></span>
<span id="cb2-112"><a href="data-cleaning.html#cb2-112"></a><span class="co"># write.csv(mtg, &quot;cleanData.csv&quot;)</span></span></code></pre></div>
<div id="post-download-formatting" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Post-Download Formatting</h3>
<p>Because certain facets of the data cannot be retained when the data is formatted as a .CSV, we produced a ‘post-download formatting’ block which can be copied and pasted in at the beginning of any R file using the above CSV to convert the data to the ideal format for manipulation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-cleaning.html#cb3-1"></a><span class="co"># TOKENIZING SUBTYPES</span></span>
<span id="cb3-2"><a href="data-cleaning.html#cb3-2"></a>mtg<span class="op">$</span>subtypes &lt;-<span class="st"> </span><span class="kw">str_split</span>(mtg<span class="op">$</span>subtypes, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb3-3"><a href="data-cleaning.html#cb3-3"></a></span>
<span id="cb3-4"><a href="data-cleaning.html#cb3-4"></a><span class="co"># TOKENIZING KEYWORDS</span></span>
<span id="cb3-5"><a href="data-cleaning.html#cb3-5"></a>mtg<span class="op">$</span>keywords &lt;-<span class="st"> </span><span class="kw">str_split</span>(mtg<span class="op">$</span>keywords, <span class="st">&quot;,&quot;</span>)</span>
<span id="cb3-6"><a href="data-cleaning.html#cb3-6"></a></span>
<span id="cb3-7"><a href="data-cleaning.html#cb3-7"></a><span class="co"># TURNING RARITY INTO A FACTOR </span></span>
<span id="cb3-8"><a href="data-cleaning.html#cb3-8"></a>mtg<span class="op">$</span>rarity &lt;-<span class="st"> </span><span class="kw">factor</span>(mtg<span class="op">$</span>rarity, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;common&quot;</span>, <span class="st">&quot;uncommon&quot;</span>, <span class="st">&quot;rare&quot;</span>, <span class="st">&quot;mythic&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-9"><a href="data-cleaning.html#cb3-9"></a></span>
<span id="cb3-10"><a href="data-cleaning.html#cb3-10"></a><span class="co">#FORMATTING POWER AND TOUGHNESS CORRECTLY</span></span>
<span id="cb3-11"><a href="data-cleaning.html#cb3-11"></a>  <span class="co"># forces some to numeric, however upon investigation the cards turned to NA&#39;s are &#39;booster&#39; cards, which are like spell cards</span></span>
<span id="cb3-12"><a href="data-cleaning.html#cb3-12"></a>  <span class="co"># these cards can be identified by their key words</span></span>
<span id="cb3-13"><a href="data-cleaning.html#cb3-13"></a>mtg<span class="op">$</span>power &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(mtg<span class="op">$</span>power)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-cleaning.html#cb5-1"></a>mtg<span class="op">$</span>toughness &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(mtg<span class="op">$</span>toughness)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-cleaning.html#cb7-1"></a><span class="kw">head</span>(mtg, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## # A tibble: 20 x 23
##    uuid  mcmId mtgjsonV4Id multiverseId name  artist type  subtypes supertypes
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;list&gt;   &lt;chr&gt;     
##  1 3851~ 16413 1669af17-d~       130483 Abun~ Rebec~ Ench~ &lt;chr [1~ &lt;NA&gt;      
##  2 b8a6~ 16227 047d5499-a~       132072 Acad~ Steph~ Crea~ &lt;chr [2~ &lt;NA&gt;      
##  3 1172~ 16511 ee19938c-4~       129458 Adar~ John ~ Land  &lt;chr [1~ &lt;NA&gt;      
##  4 9acf~ 16289 8774e18f-3~       135206 Affl~ Roger~ Inst~ &lt;chr [1~ &lt;NA&gt;      
##  5 0dea~ 16414 4e875bca-0~       130525 Aggr~ Chris~ Inst~ &lt;chr [1~ &lt;NA&gt;      
##  6 4429~ 16290 13fbd62d-8~       135228 Agon~ Adam ~ Sorc~ &lt;chr [1~ &lt;NA&gt;      
##  7 76dd~ 16228 2854f284-9~       129459 Air ~ Kev W~ Crea~ &lt;chr [1~ &lt;NA&gt;      
##  8 76d4~ 16228 9d9ce25a-f~           NA Air ~ Kev W~ Crea~ &lt;chr [1~ &lt;NA&gt;      
##  9 2972~ 16229 f9db3498-1~       129913 Amba~ Jim M~ Lege~ &lt;chr [2~ Legendary 
## 10 5119~ 16351 fe4aa077-8~       134753 Anab~ Greg ~ Crea~ &lt;chr [1~ &lt;NA&gt;      
## 11 0809~ 16351 067159f1-c~           NA Anab~ Greg ~ Crea~ &lt;chr [1~ &lt;NA&gt;      
## 12 5f82~ 16165 ad41be73-5~       130550 Ance~ Pete ~ Crea~ &lt;chr [2~ &lt;NA&gt;      
## 13 b7c1~ 16165 fcd5d3ab-d~           NA Ance~ Pete ~ Crea~ &lt;chr [2~ &lt;NA&gt;      
## 14 57aa~ 16166 9eb2e54c-a~       129465 Ange~ Volka~ Crea~ &lt;chr [1~ &lt;NA&gt;      
## 15 8fd4~ 16166 e2be2630-a~           NA Ange~ Volka~ Crea~ &lt;chr [1~ &lt;NA&gt;      
## 16 da0a~ 16475 cf706172-3~       129466 Ange~ Alan ~ Arti~ &lt;chr [1~ &lt;NA&gt;      
## 17 55bd~ 16167 8fb2ccd5-7~       129711 Ange~ Mark ~ Sorc~ &lt;chr [1~ &lt;NA&gt;      
## 18 c565~ 16167 53438513-1~           NA Ange~ Mark ~ Sorc~ &lt;chr [1~ &lt;NA&gt;      
## 19 3b77~ 16168 bef2dc94-7~       129710 Ange~ Jim M~ Ench~ &lt;chr [1~ &lt;NA&gt;      
## 20 fadd~ 16169 cff007ed-d~       129671 Ange~ John ~ Crea~ &lt;chr [1~ &lt;NA&gt;      
## # ... with 14 more variables: convertedManaCost &lt;dbl&gt;, keywords &lt;list&gt;,
## #   text &lt;chr&gt;, flavorText &lt;chr&gt;, power &lt;dbl&gt;, toughness &lt;dbl&gt;, rarity &lt;ord&gt;,
## #   edhrecRank &lt;dbl&gt;, isOnlineOnly &lt;dbl&gt;, genericManaCost &lt;chr&gt;,
## #   manaColor &lt;chr&gt;, colorManaCost &lt;chr&gt;, setName &lt;chr&gt;, releaseDate &lt;date&gt;</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-quality-metrics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descriptive-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
